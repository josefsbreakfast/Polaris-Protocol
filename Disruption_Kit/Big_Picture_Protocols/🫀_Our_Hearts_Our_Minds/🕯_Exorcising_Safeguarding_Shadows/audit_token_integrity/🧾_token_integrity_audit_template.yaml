---
title: "ðŸ§¾ Token Integrity & Relationship Direction Audit"
created: 2025-11-10
version: 1.0
authors:
  - Polaris Systems & Governance Working Group
purpose: >
  To assess the integrity of pseudonymised identifiers (â€œtokensâ€)
  and relationship fields across justice, safeguarding, and research datasets.
  The audit verifies that role direction (victim/offender/related) remains
  accurate and that token rotation or re-tokenisation has not introduced duplication.

---

# ðŸ§­ SCOPE

systems_included:
  - "SystmOne / EMIS (Health)"
  - "Mosaic / LiquidLogic (Local Authority)"
  - "nDelius / OASys / P-NOMIS (Justice)"
  - "ECINS / MARAC / MAPPA Portals (Safeguarding)"
  - "ADR UK / ONS Secure Research Service mirrors"
date_range: "YYYY-MM-DD to YYYY-MM-DD"
data_controller_contact: "Name / Email"
audit_lead: "Name / Role"
supervising_body: "Information Governance Board / DPO"

---

# ðŸ§© TOKEN LINEAGE CHECK

token_generation_methods:
  - "Describe how tokens are created (hash, encryption, salt)."
  - "List any known re-tokenisation or migration events."

token_integrity_tests:
  - id: 1
    name: "Token Collision"
    description: "Identify duplicate pseudonym tokens attached to distinct demographic profiles."
    method: "Run SQL or script to count distinct tokens vs distinct source IDs."
    result: "Collision rate (%)"
  - id: 2
    name: "Token Rotation"
    description: "Check for token reissuance events without mapped lookup preservation."
    method: "Compare token creation timestamps across datasets."
    result: "Number of rotations without lookup (%)."
  - id: 3
    name: "Token Mapping Table Integrity"
    description: "Confirm lookup tables between token generations are encrypted and reconciled."
    method: "Inspect metadata or system documentation."
    result: "Integrity rating (Good / Fair / Poor)."

---

# âš™ï¸ RELATIONSHIP DIRECTION CHECK

relationship_fields:
  - "victim_of"
  - "offender_of"
  - "related_to"
  - "case_id"

directionality_tests:
  - id: 4
    name: "Null Role Fields"
    description: "Count missing or blank role-direction fields."
    result: "Null role field rate (%)"
  - id: 5
    name: "Role Inversion"
    description: "Check whether the same ID appears as both victim and offender within same case."
    result: "Inversion count / total cases"
  - id: 6
    name: "Case-Level Joins"
    description: "Identify joins made on case_id rather than person_id."
    result: "Number of non-person joins detected."

---

# ðŸ§¾ AUDIT TRAIL & PROPAGATION

audit_trail_checks:
  - "Verify that every token merge or de-duplication event logs date, actor, and reason."
  - "Sample at least 10 events per system."
correction_propagation:
  - "Measure time (days) between correction in primary system and reflection in mirror datasets."
  - "Propagation lag average (days): ____"

---

# ðŸ§® REPORTING METRICS

metrics_summary:
  token_collision_rate: "____ %"
  token_rotation_without_lookup: "____ %"
  null_role_field_rate: "____ %"
  role_inversion_count: "____"
  case_level_joins_detected: "____"
  propagation_lag_days: "____"

risk_rating:
  overall: "Low / Moderate / High"
  commentary: >
    "Summarise systemic weaknesses, e.g. legacy schema, vendor misalignment, or under-resourced QA."

recommendations:
  - "Implement unique token namespaces for victims vs offenders."
  - "Add automated directionality validation before data export."
  - "Mandate quarterly reconciliation of token mapping tables."
  - "Publish correction-propagation dashboard for DPO review."

next_audit_due: "YYYY-MM-DD"

---

# ðŸ“š REFERENCES
- UK GDPR Article 5(1)(d) â€“ Accuracy principle  
- Data Protection Act 2018 Section 171  
- ICO Data-Sharing Code of Practice (2021)  
- ISO/IEC 27701 Â§ 7.4 â€“ Pseudonymisation integrity  
- NIST SP 800-188 â€“ De-identification risk metrics  
